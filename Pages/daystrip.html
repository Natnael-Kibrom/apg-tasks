<!DOCTYPE html>
<html lang="en" class="transition-colors duration-300 dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trip Day Allocator</title>
    <meta name="description" content="Allocate days evenly across trips with rounding." />

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    <link rel="stylesheet" href="../CSS/trip.css" />
    
</head>

<body class="bg-gray-100 dark:bg-gray-900 min-h-screen text-gray-800 dark:text-gray-100 transition-colors duration-300">
    <nav class="navbar navbar-dark bg-dark navbar-expand-lg mb-4">
        <div class="container w-75">
            <a class="navbar-brand" href="./index.html">Agp Task</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown"
                aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="navbar-collapse justify-content-end" id="navbarNavDropdown">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" aria-current="page" href="./index.html">Driver Payment</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="./travelallowance.html">Allowance Print</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container">
        <div class="row justify-content-center">
            <div class="col-md-6 col-lg-5">
                <div class="bg-white dark:bg-gray-800 shadow-lg rounded-xl p-4 p-md-5">
                    <div class="d-flex justify-content-between align-items-center mb-4">
                        <h1 class="h2 fw-bold">Trip Day Allocator</h1>
                        <button onclick="toggleDarkMode()" class="btn btn-outline-secondary btn-sm">
                            ðŸŒ— Switch to Light
                        </button>
                    </div>

                    <div class="mb-3">
                        <label for="trips" class="form-label">Number of Trips</label>
                        <input type="number" id="trips" value="" class="form-control" />
                    </div>

                    <div class="mb-4">
                        <label for="days" class="form-label">Total Days</label>
                        <input type="number" id="days" value="" step="1" class="form-control" />
                    </div>

                    <button onclick="allocateDays()" class="btn btn-primary w-100 fw-semibold py-2">
                        Calculate Allocation
                    </button>

                    <div id="resultContainer" class="mt-4 d-none">
                        <h2 class="h5 fw-semibold mb-2">Result:</h2>
                        <pre id="result" class="bg-light dark:bg-gray-700 p-3 rounded fade-in text-dark"></pre>
                    </div>

                    <div id="historyContainer" class="mt-4">
                        <h3 class="h6 fw-semibold mb-2">ðŸ“œ Past Results:</h3>
                        <ul id="historyList" class="list-unstyled overflow-auto text-dark" style="max-height: 200px;">
                            <!-- Past results go here -->
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS Bundle with Popper -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Initialize dark mode on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Set dark mode as default
            document.documentElement.classList.add('dark');
            
            // Update navbar for dark mode
            const navbar = document.querySelector('.navbar');
            navbar.classList.remove('bg-dark');
            navbar.classList.add('bg-dark');
            
            // Update button text
            const themeButton = document.querySelector('.btn-outline-secondary');
            themeButton.textContent = 'ðŸŒ— Switch to Light';
        });

        function allocateDays() {
            const trips = parseInt(document.getElementById("trips").value);
            const totalDays = parseFloat(document.getElementById("days").value);
            const resultEl = document.getElementById("result");
            const resultContainer = document.getElementById("resultContainer");
            const historyList = document.getElementById("historyList");

            const avg = totalDays / trips;
            const roundedAvg = parseFloat(avg.toFixed(1));
            const exactTotal = parseFloat((roundedAvg * trips).toFixed(1));

            let output = '';

            if (exactTotal === totalDays) {
                output = `${trips} trip${trips !== 1 ? 's' : ''} with ${roundedAvg.toFixed(1)} days\nTotal: ${exactTotal.toFixed(1)} days`;
            } else {
                const base = Math.floor(avg * 10) / 10;
                const diff = totalDays - base * trips;
                const highCount = Math.round(diff / 0.1);
                const lowCount = trips - highCount;
                const high = (base + 0.1).toFixed(1);
                const low = base.toFixed(1);

                output += `${highCount} trip${highCount !== 1 ? 's' : ''} with ${high} days\n`;
                output += `${lowCount} trip${lowCount !== 1 ? 's' : ''} with ${low} days\n`;
                const total = (highCount * high + lowCount * low).toFixed(1);
                output += `Total: ${total} days`;
            }

            // Show result
            resultEl.textContent = output;
            resultContainer.classList.remove("d-none");
            resultEl.classList.remove("fade-in");
            void resultEl.offsetWidth;
            resultEl.classList.add("fade-in");

            // Save to history
            const li = document.createElement("li");
            li.className = "bg-light dark:bg-gray-700 p-2 rounded mb-2 whitespace-pre-line";
            li.textContent = output;
            historyList.prepend(li);
        }

        function toggleDarkMode() {
            const html = document.documentElement;
            const isDark = html.classList.toggle('dark');
            
            // Update button text based on current mode
            const themeButton = document.querySelector('.btn-outline-secondary');
            themeButton.textContent = isDark ? 'ðŸŒ— Switch to Light' : 'ðŸŒ— Switch to Dark';

            // Update Bootstrap navbar colors
            const navbar = document.querySelector('.navbar');
            if (isDark) {
                navbar.classList.remove('bg-dark');
                navbar.classList.add('bg-dark');
            } else {
                navbar.classList.add('bg-dark');
            }
        }
    </script>
</body>


</html>
